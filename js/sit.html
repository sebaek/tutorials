<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }


        .container {
            margin-left: 5%;
            margin-right: 5%;
            display: flex;
            justify-content: space-between;
            flex-direction: row;
        }

        .tab {
            display: flex;
            flex-basis: 48%;
            flex-direction: column;
        }

        .row {
            display: flex;
            flex: 1;
        }

        .cell {
            flex: 1;
        }

        .name {
            line-height: 600%;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="tab">
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab">
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
                <div class="cell">
                    <div class="name w3-card-4 w3-center">
                        <h1>_</h1>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div style="text-align: center;">
        <button id='go-button' class="w3-button w3-jumbo w3-lime w3-center">GO</button>
        <button id='stop-button' class="w3-button w3-jumbo w3-red w3-center">STOP</button>
    </div>
    <div class='w3-panel w3-cyan'>
        <h1 id='name-card' style='text-align: center;'>_</h1>
    </div>

    <script>
        $(document).ready(function () {
            $("#go-button").click(go);
            $("#stop-button").click(stop).attr('disabled', true);

            var numberOfPeople = 30;
            var nameH1 = $('div.name>h1');
            var i = 0;
            $('.name').each(function () {
                $(this).attr('id', 'name-' + i++);
            });
            var names = '1,2,3,4,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z'.split(',');

            var nameNumbers = new Set();
            var sitNumbers = new Set();

            var nameNumber;

            for (i = 0; i < numberOfPeople; i++) {
                nameNumbers.add(i);
                sitNumbers.add(i);
            }

            var intervalFn;
            function go() {
                $("#go-button").attr('disabled', true);
                $("#stop-button").attr('disabled', false);

                nameNumber = getAndDeleteNext(nameNumbers);
                $("#name-card").text(names[nameNumber]);
                intervalFn = setInterval(function () {
                    if (sitNumbers.size == 0) return;
                    var sitnum = getNext(sitNumbers);
                    // console.log($('#name-' + sitnum).text());

                    $('#name-' + sitnum + '>h1').text(names[nameNumber]).parent().addClass('w3-blue').animate({ "color": "black" }, 90, function () {
                        $(this).animate({ "color": "black" }, 10).removeClass('w3-blue');
                        $('#name-' + sitnum + '>h1').text("_");
                        console.log('change');
                    });

                }, 90);
            }

            function stop() {
                $("#go-button").attr('disabled', false);
                $("#stop-button").attr('disabled', true);
                $("#name-card").text('_');
                clearInterval(intervalFn);
                setTimeout(function () {
                    var sitnum = getAndDeleteNext(sitNumbers);
                    $('#name-' + sitnum + '>h1').text(names[nameNumber]).parent().addClass('w3-blue');
                    console.log(sitNumbers.size + " " + nameNumbers.size);
                }, 200);
                
            }





            function getAndDeleteNext(set) {
                var number;
                do {
                    number = Math.floor(Math.random() * numberOfPeople);
                } while (!set.has(number));

                set.delete(number);
                return number;
            }

            function getNext(set) {
                var number;
                do {
                    number = Math.floor(Math.random() * numberOfPeople);
                } while (!set.has(number));

                return number;
            }

        });
    </script>
</body>

</html>